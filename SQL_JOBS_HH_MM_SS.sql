select 
JOBS,
To_Char(To_Date(start_ts,'DD-MM-YY HH:MI:SS'),'HH:MI:SS') hora_ini,
COUNT(*)
from as400jobs
GROUP BY JOBS,
To_Char(To_Date(start_ts,'DD-MM-YY HH:MI:SS'),'HH:MI:SS');

SELECT JOBS, SYSTEM, TS, START_TS, END_TS , 
ROUND((To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))/0.0000115740740740741,10) DURACION 
FROM as400jobs WHERE STATUS IN ('C') and JOBS IN 
('CCECDSCD7',
'CCECDSCD8',
'SW94001P');

SELECT To_Char(To_Date(start_ts,'DD-MM-YYYY HH24:MI:SS'),'DD/MM/YYYY'), JOBS, COUNT(*) FROM AS400JOBS
GROUP BY To_Char(To_Date(start_ts,'DD-MM-YYYY HH24:MI:SS'),'DD/MM/YYYY'), JOBS;

SELECT JOBS,
To_Char(To_Date(start_ts,'DD-MM-YYYY HH24:MI:SS'),'YYYY') YYYY,
To_Char(To_Date(start_ts,'DD-MM-YYYY HH24:MI:SS'),'MM') MM,
--To_Char(To_Date(start_ts,'DD-MM-YYYY HH24:MI:SS'),'DD') DD,
ROUND(MIN(To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))/0.0000115740740740741,4) DUR_MIN,
ROUND(AVG(To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))/0.0000115740740740741,4) DUR_AVG, 
ROUND((PERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY (To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))))/0.0000115740740740741,4) DUR_P95,
ROUND(MAX(To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))/0.0000115740740740741,4) DUR_MAX,
ROUND(SUM(To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))/0.0000115740740740741,4) DUR_SUM,
ROUND(STDDEV(To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))/0.0000115740740740741,8) DUR_SD,
CASE WHEN ROUND(MAX(To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))/0.0000115740740740741,4)>0 THEN ROUND((AVG(To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))/MAX(To_Date(END_TS,'DD-MM-YY HH24:MI:SS')-To_Date(START_TS,'DD-MM-YY HH24:MI:SS'))),4) ELSE NULL END AVG_PICO
FROM 
AS400JOBS
WHERE STATUS IN ('C') AND 
JOBS IN 
('CCECDSCD7',
'CCECDSCD8',
'SW94001P')
GROUP BY JOBS,
To_Char(To_Date(start_ts,'DD-MM-YYYY HH24:MI:SS'),'YYYY')
,
To_Char(To_Date(start_ts,'DD-MM-YYYY HH24:MI:SS'),'MM')
--,
--To_Char(To_Date(start_ts,'DD-MM-YYYY HH24:MI:SS'),'DD') 
;

CASE WHEN To_Date(HORA_FIN,'HH24:MI:SS') > To_Date(HORA_INI,'HH24:MI:SS') THEN AVG(To_Date(HORA_FIN,'HH24:MI:SS')-To_Date(HORA_INI,'HH24:MI:SS'))/0.0000115740740740741 
ELSE -1 END DUR 
FROM
AS400_JOBS_INI_FIN
GROUP BY 
JOBS,
CASE WHEN To_Date(HORA_FIN,'HH24:MI:SS') > To_Date(HORA_INI,'HH24:MI:SS') THEN AVG(To_Date(HORA_FIN,'HH24:MI:SS')-To_Date(HORA_INI,'HH24:MI:SS'))/0.0000115740740740741 
ELSE -1 END
ORDER BY 1;

select 
*
from AS400_JOBS_INI_FIN;