SELECT    
DETALLES_DEUDAS_2.DEUDA, 
DETALLES_DEUDAS_2.IMPORTE_RESTANTE,  
DETALLES_DEUDAS_2.CLASE, DETALLES_DEUDAS_2.ID,  
DETALLES_DEUDAS_2.ID_EMPRESA,  DETALLES_DEUDAS_2.RAZON_SOCIAL    
FROM DETALLES_DEUDAS_2 
LEFT JOIN PAGOS   ON DETALLES_DEUDAS_2.ID=PAGOS.ID_DOCU   
WHERE    (DETALLES_DEUDAS_2.CLASE="FT" AND    	
	DETALLES_DEUDAS_2.[ID_EMPRESA]=IIF([TX_ID_EMPRESA]="NA",-1,[TX_ID_EMPRESA]) AND
	DETALLES_DEUDAS_2.IMPORTE_RESTANTE>0)    UNION 
SELECT   DETALLES_DEUDAS_2.DEUDA, DETALLES_DEUDAS_2.IMPORTE_RESTANTE,    
DETALLES_DEUDAS_2.CLASE, DETALLES_DEUDAS_2.ID, DETALLES_DEUDAS_2.ID_EMPRESA,  
DETALLES_DEUDAS_2.RAZON_SOCIAL  FROM DETALLES_DEUDAS_2   
LEFT JOIN PAGOS  ON DETALLES_DEUDAS_2.ID=PAGOS.ID_DOCU   
WHERE    (DETALLES_DEUDAS_2.CLASE="SF"  AND   DETALLES_DEUDAS_2.[RAZON_SOCIAL]=[TX_CLIENTE] AND
DETALLES_DEUDAS_2.IMPORTE_RESTANTE>0 );
